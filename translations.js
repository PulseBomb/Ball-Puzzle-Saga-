// translations.js

// ----------------------------------
// Language Translations
// ----------------------------------
export const translations = {
    ar: { // ترجمات اللغة العربية
        game_title: 'ملحمة ألغاز الكرة',
        gold_label: 'الذهب:',
        level_label: 'المستوى:',
        quests_button: 'المهام',
        settings_button: 'الإعدادات',
        your_quests_title: 'مهامك',
        daily_quests_title: 'المهام اليومية',
        weekly_quests_title: 'المهام الأسبوعية',
        music_volume_label: 'مستوى صوت الموسيقى:',
        sfx_volume_label: 'مستوى صوت المؤثرات:',
        toggle_music_on: 'إيقاف الموسيقى',
        toggle_music_off: 'تشغيل الموسيقى',
        toggle_sfx_on: 'إيقاف المؤثرات الصوتية',
        toggle_sfx_off: 'تشغيل المؤثرات الصوتية',
        language_label: 'اللغة:',
        current_language: 'العربية',
        loading_message: 'جارٍ التحميل...',
        initial_message: 'رتّب الكرات حسب اللون',
        undo_button: 'تراجع',
        reset_button: 'إعادة',
        hint_button: 'تلميح',
        buy_tube_button: 'أنبوب',
        skip_button: 'تخطي',
        tube_capacity_label: 'سعة الأنبوب:',
        player_id_label: 'معرّفك: ',
        username_label: 'اسم المستخدم:',
        save_button_text: 'حفظ الاسم',
        username_length_error: 'اسم المستخدم يجب أن يكون بين 3 و 20 حرفًا.',
        username_saved_success: 'تم حفظ اسم المستخدم بنجاح!',
        your_id_label: 'الخاص بك',
        level_ready: (params) => `المستوى ${params.level} جاهز!`,
        tube_empty_error: 'هذا الأنبوب فارغ!',
        invalid_move_error: (params) => `حركة غير صالحة! خسارة ${params.goldLoss} ذهب.`,
        level_complete_success: (params) => `المستوى ${params.level} اكتمل! +${params.gold} ذهب.`,
        undo_cost_error: (params) => `تحتاج ${params.cost} ذهب للتراجع.`,
        undo_success: 'تم التراجع عن الحركة.',
        no_moves_to_undo: 'لا توجد حركات للتراجع عنها!',
        reset_confirm: 'هل أنت متأكد أنك تريد إعادة ضبط المستوى الحالي؟ ستخسر تقدمك في هذا المستوى.',
        level_reset_success: 'تم إعادة ضبط المستوى.',
        hint_cost_error: (params) => `تحتاج ${params.cost} ذهب للحصول على تلميح.`,
        hint_message: (params) => `تلميح: انقل الكرة من أنبوب ${params.from + 1} إلى أنبوب ${params.to + 1}`,
        hint_not_found: 'لا يمكن العثور على تلميح في الوقت الحالي. حاول تحريك الكرات لإنشاء مساحة.',
        buy_tube_cost_error: (params) => `تحتاج ${params.cost} ذهب لشراء أنبوب`,
        buy_tube_success: 'تم شراء أنبوب إضافي!',
        daily_gold_reward: (params) => `لقد حصلت على ${params.goldAmount} ذهب كمكافأة يومية!`,
        tube_locked_error: 'لا يمكن تحريك الكرات من هذا الأنبوب! الكرة مقفلة في الأسفل.',
        ball_locked_error: 'لا يمكن تحريك هذه الكرة مباشرة؛ يجب تحريرها أولاً!',
        quest_completed_msg: (params) => `مهمة "${params.desc}" مكتملة!`,
        quest_claimed_msg: (params) => `تم المطالبة بمكافأة مهمة "${params.desc}"!`,
        progress_label: 'التقدم:',
        reward_label: 'المكافأة:',
        claim_reward_button: 'المطالبة بالمكافأة',
        new_achievement_unlocked: (params) => `إنجاز جديد: ${params.name}! (+${params.reward} ذهب)`,
        daily_level_complete_desc: (params) => `أكمل ${params.target} مستويات`,
        weekly_undo_use_desc: (params) => `استخدم التراجع ${params.target} مرات`,
        daily_collect_gold_desc: (params) => `اجمع ${params.target} ذهب`,
        achievement_speed_runner_name: 'عدّاء السرعة',
        achievement_speed_runner_desc: 'أكمل 5 مستويات في أقل من 50 حركة إجمالية',
        achievement_perfectionist_name: 'مثالي',
        achievement_perfectionist_desc: 'أكمل 10 مستويات بدون أي تراجع',
        achievement_gold_hoarder_name: 'جامع الذهب',
        achievement_gold_hoarder_desc: 'اجمع 1000 قطعة ذهبية',
        achievement_first_tube_buyer_name: 'المستثمر الأول',
        achievement_first_tube_buyer_desc: 'اشترِ أول أنبوب إضافي',
        login_required_for_reward: 'الرجاء تسجيل الدخول لاستلام الهدية.',
        reward_already_claimed: 'تم استلام هذه الهدية من قبل.',
        reward_claimed_success: (params) => `تم استلام ${params.amount} ذهب بنجاح!`,
        error_claiming_reward: 'حدث خطأ أثناء استلام الهدية.',
        no_current_notifications: 'لا توجد إشعارات حالياً.',
        loading_game: 'جار تحميل بيانات اللعبة...',
        puzzle_generation_error: 'حدث خطأ أثناء توليد اللغز. يرجى المحاولة مرة أخرى.',
        load_game_error: 'فشل تحميل بيانات اللعبة. بدء لعبة جديدة.',
        loading_rankings: 'جار تحميل الترتيب...',
        rankings: 'الترتيب',
        rankings_text: 'عرض الترتيب',
        no_players_found: 'لم يتم العثور على لاعبين.',
        error_loading_rankings: 'حدث خطأ أثناء تحميل الترتيب.',
        top_players: 'أفضل اللاعبين',
        level_label: 'المستوى',
        gold_label: 'الذهب'
    },

    en: {
        game_title: 'Ball Puzzle Saga',
        gold_label: 'Gold:',
        level_label: 'Level:',
        quests_button: 'Quests',
        settings_button: 'Settings',
        your_quests_title: 'Your Quests',
        daily_quests_title: 'Daily Quests',
        weekly_quests_title: 'Weekly Quests',
        music_volume_label: 'Music Volume:',
        sfx_volume_label: 'SFX Volume:',
        toggle_music_on: 'Music ON',
        toggle_music_off: 'Music OFF',
        toggle_sfx_on: 'SFX ON',
        toggle_sfx_off: 'SFX OFF',
        language_label: 'Language:',
        current_language: 'English',
        loading_message: 'Loading...',
        initial_message: 'Sort balls by color',
        undo_button: 'Undo',
        reset_button: 'Reset',
        hint_button: 'Hint',
        buy_tube_button: 'Tube',
        skip_button: 'Skip',
        tube_capacity_label: 'Tube Capacity:',
        player_id_label: 'Your ID: ',
        username_label: 'Username:',
        save_button_text: 'Save Name',
        username_length_error: 'Username must be between 3 and 20 characters.',
        username_saved_success: 'Username saved successfully!',
        your_id_label: 'Your ID',
        level_ready: (params) => `Level ${params.level} ready!`,
        tube_empty_error: 'This tube is empty!',
        invalid_move_error: (params) => `Invalid move! Lose ${params.goldLoss} gold.`,
        level_complete_success: (params) => `Level ${params.level} complete! +${params.gold} Gold.`,
        undo_cost_error: (params) => `You need ${params.cost} gold to undo.`,
        undo_success: 'Move undone.',
        no_moves_to_undo: 'No moves to undo!',
        reset_confirm: 'Are you sure you want to reset the current level? You will lose your progress for this level.',
        level_reset_success: 'Level reset.',
        hint_cost_error: (params) => `You need ${params.cost} gold for a hint.`,
        hint_message: (params) => `Hint: Move ball from tube ${params.from + 1} to tube ${params.to + 1}`,
        hint_not_found: 'No hint found at the moment. Try moving balls to create space.',
        buy_tube_cost_error: (params) => `You need ${params.cost} gold to buy a tube`,
        buy_tube_success: 'Extra tube purchased!',
        daily_gold_reward: (params) => `You received ${params.goldAmount} gold as a daily reward!`,
        tube_locked_error: 'Cannot move balls from this tube! A ball is locked at the bottom.',
        ball_locked_error: 'This ball cannot be moved directly; it must be freed first!',
        quest_completed_msg: (params) => `Quest "${params.desc}" completed!`,
        quest_claimed_msg: (params) => `Claimed reward for "${params.desc}" quest!`,
        progress_label: 'Progress:',
        reward_label: 'Reward:',
        claim_reward_button: 'Claim Reward',
        new_achievement_unlocked: (params) => `New achievement: ${params.name}! (+${params.reward} gold)`,
        daily_level_complete_desc: (params) => `Complete ${params.target} levels`,
        weekly_undo_use_desc: (params) => `Use undo ${params.target} times`,
        daily_collect_gold_desc: (params) => `Collect ${params.target} gold`,
        achievement_speed_runner_name: 'Speed Runner',
        achievement_speed_runner_desc: 'Complete 5 levels in less than 50 total moves',
        achievement_perfectionist_name: 'Perfectionist',
        achievement_perfectionist_desc: 'Complete 10 levels without any undo',
        achievement_gold_hoarder_name: 'Gold Hoarder',
        achievement_gold_hoarder_desc: 'Collect 1000 gold',
        achievement_first_tube_buyer_name: 'First Tube Buyer',
        achievement_first_tube_buyer_desc: 'Buy your first extra tube',
        login_required_for_reward: 'Please log in to claim the reward.',
        reward_already_claimed: 'This reward has already been claimed.',
        reward_claimed_success: (params) => `Successfully claimed ${params.amount} gold!`,
        error_claiming_reward: 'An error occurred while claiming the reward.',
        no_current_notifications: 'No notifications currently.',
        loading_game: 'Loading game data...',
        puzzle_generation_error: 'Error generating puzzle. Please try again.',
        load_game_error: 'Failed to load game data. Starting new game.',
        loading_rankings: 'Loading Rankings...',
        rankings: 'Rankings',
        rankings_text: 'View Rankings',
        no_players_found: 'No players found.',
        error_loading_rankings: 'An error occurred while loading rankings.',
        top_players: 'Top Players',
        level_label: 'Level',
        gold_label: 'Gold'
    },

    ru: {
        game_title: 'Сага о головоломке с шариками',
        gold_label: 'Золото:',
        level_label: 'Уровень:',
        quests_button: 'Задания',
        settings_button: 'Настройки',
        your_quests_title: 'Ваши задания',
        daily_quests_title: 'Ежедневные задания',
        weekly_quests_title: 'Еженедельные задания',
        music_volume_label: 'Громкость музыки:',
        sfx_volume_label: 'Громкость звуковых эффектов:',
        toggle_music_on: 'Музыка ВКЛ',
        toggle_music_off: 'Музыка ВЫКЛ',
        toggle_sfx_on: 'Звуковые эффекты ВКЛ',
        toggle_sfx_off: 'Звуковые эффекты ВЫКЛ',
        language_label: 'Язык:',
        current_language: 'Русский',
        loading_message: 'Загрузка...',
        initial_message: 'Сортируйте шарики по цвету',
        undo_button: 'Отменить',
        reset_button: 'Сбросить',
        hint_button: 'Подсказка',
        buy_tube_button: 'Трубка',
        skip_button: 'Пропустить',
        tube_capacity_label: 'Вместимость трубки:',
        player_id_label: 'Ваш ID: ',
        username_label: 'Имя пользователя:',
        save_button_text: 'Сохранить имя',
        username_length_error: 'Имя пользователя должно содержать от 3 до 20 символов.',
        username_saved_success: 'Имя пользователя успешно сохранено!',
        your_id_label: 'Ваш ID',
        level_ready: (params) => `Уровень ${params.level} готов!`,
        tube_empty_error: 'Эта трубка пуста!',
        invalid_move_error: (params) => `Недопустимый ход! Потеряно ${params.goldLoss} золота.`,
        level_complete_success: (params) => `Уровень ${params.level} пройден! +${params.gold} золота.`,
        undo_cost_error: (params) => `Вам нужно ${params.cost} золота для отмены хода.`,
        undo_success: 'Ход отменен.',
        no_moves_to_undo: 'Нет ходов для отмены!',
        reset_confirm: 'Вы уверены, что хотите сбросить текущий уровень? Ваш прогресс на этом уровне будет потерян.',
        level_reset_success: 'Уровень сброшен.',
        hint_cost_error: (params) => `Вам нужно ${params.cost} золота для подсказки.`,
        hint_message: (params) => `Подсказка: Переместите шарик из трубки ${params.from + 1} в трубку ${params.to + 1}`,
        hint_not_found: 'Подсказка не найдена. Попробуйте переместить шарики, чтобы создать пространство.',
        buy_tube_cost_error: (params) => `Вам нужно ${params.cost} золота для покупки трубки`,
        buy_tube_success: 'Дополнительная трубка куплена!',
        daily_gold_reward: (params) => `Вы получили ${params.goldAmount} золота в качестве ежедневной награды!`,
        tube_locked_error: 'Нельзя перемещать шарики из этой трубки! Шарик заблокирован внизу.',
        ball_locked_error: 'Этот шарик нельзя переместить напрямую; его нужно сначала освободить!',
        quest_completed_msg: (params) => `Задание "${params.desc}" выполнено!`,
        quest_claimed_msg: (params) => `Награда за задание "${params.desc}" получена!`,
        progress_label: 'Прогресс:',
        reward_label: 'Награда:',
        claim_reward_button: 'Получить награду',
        new_achievement_unlocked: (params) => `Новое достижение: ${params.name}! (+${params.reward} золота)`,
        daily_level_complete_desc: (params) => `Пройдите ${params.target} уровней`,
        weekly_undo_use_desc: (params) => `Используйте отмену хода ${params.target} раз`,
        daily_collect_gold_desc: (params) => `Соберите ${params.target} золота`,
        achievement_speed_runner_name: 'Скоростной бегун',
        achievement_speed_runner_desc: 'Пройдите 5 уровней за менее чем 50 ходов всего',
        achievement_perfectionist_name: 'Перфекционист',
        achievement_perfectionist_desc: 'Пройдите 10 уровней без использования отмены',
        achievement_gold_hoarder_name: 'Собиратель золота',
        achievement_gold_hoarder_desc: 'Соберите 1000 золота',
        achievement_first_tube_buyer_name: 'Первый покупатель трубки',
        achievement_first_tube_buyer_desc: 'Купите первую дополнительную трубку',
        login_required_for_reward: 'Пожалуйста, войдите, чтобы получить награду.',
        reward_already_claimed: 'Эта награда уже была получена.',
        reward_claimed_success: (params) => `Успешно получено ${params.amount} золота!`,
        error_claiming_reward: 'Произошла ошибка при получении награды.',
        no_current_notifications: 'На данный момент уведомлений нет.',
        loading_game: 'Загрузка данных игры...',
        puzzle_generation_error: 'Ошибка при создании головоломки. Пожалуйста, попробуйте снова.',
        load_game_error: 'Не удалось загрузить данные игры. Начинается новая игра.',
        loading_rankings: 'Загрузка рейтинга...',
        rankings: 'Рейтинг',
        rankings_text: 'Посмотреть рейтинг',
        no_players_found: 'Игроки не найдены.',
        error_loading_rankings: 'Произошла ошибка при загрузке рейтинга.',
        top_players: 'Лучшие игроки',
        level_label: 'Уровень',
        gold_label: 'Золото'
    }
};

// الدوال المساعدة للترجمة
export function getTranslation(key, params = {}) {
    const langData = translations[window.gameState.currentLanguage];
    if (langData && langData[key]) {
        const text = langData[key];
        if (typeof text === 'function') {
            return text(params);
        }
        return text;
    }
    console.warn(`Translation key '${key}' not found for language '${window.gameState.currentLanguage}'`);
    return key;
}

export function setLanguage(lang) {
    if (!translations[lang]) {
        console.error(`Language '${lang}' not supported.`);
        return;
    }
    window.gameState.currentLanguage = lang;
    window.saveGame();
    window.updateLanguageUI();
}
